<!-- 사용자 프로필 다이얼로그 -->
<dialog
  id="userProfileDialog"
  class="rounded-lg shadow-lg border p-6 max-w-md bg-white"
>
  <div class="flex justify-between items-start mb-4">
    <h3 class="text-lg font-semibold text-gray-900">사용자 정보</h3>
    <button
      type="button"
      onclick="closeUserProfile()"
      class="text-gray-400 hover:text-gray-600"
      aria-label="닫기"
    >
      <svg
        width="20"
        height="20"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
  </div>

  <div id="userProfileContent" class="space-y-3">
    <div>
      <span class="text-sm text-gray-500">이름</span>
      <p id="userName" class="font-medium"></p>
    </div>
    <div>
      <span class="text-sm text-gray-500">관심사</span>
      <div id="userInterests" class="flex flex-wrap gap-1 mt-1"></div>
    </div>
    <div>
      <span class="text-sm text-gray-500">자기소개</span>
      <p id="userDescription" class="text-sm text-gray-600 mt-1"></p>
    </div>
  </div>
</dialog>

<script>
  async function showUserProfile(userId) {
    try {
      const response = await fetch(`/user/${userId}/profile`, {
        headers: { "X-Requested-With": "XMLHttpRequest" },
      });

      if (response.ok) {
        const user = await response.json();

        document.getElementById("userName").textContent = user.name;
        document.getElementById("userDescription").textContent =
          user.description || "자기소개가 없습니다.";

        const interestsContainer = document.getElementById("userInterests");
        interestsContainer.innerHTML = "";

        if (user.interest_of_subject && user.interest_of_subject.length > 0) {
          user.interest_of_subject.forEach((interest) => {
            const tag = document.createElement("span");
            tag.className =
              "bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full";
            tag.textContent = interest;
            interestsContainer.appendChild(tag);
          });
        } else {
          interestsContainer.innerHTML =
            '<span class="text-gray-400 text-xs">관심사가 없습니다.</span>';
        }

        document.getElementById("userProfileDialog").showModal();
      }
    } catch (error) {
      console.error("사용자 정보 조회 오류:", error);
      alert("사용자 정보를 불러올 수 없습니다.");
    }
  }

  function closeUserProfile() {
    document.getElementById("userProfileDialog").close();
  }
</script>
