{% macro tag_buttons(tags, input_id="selectedInterests", label="관심사") %}
<div>
  <label class="block text-sm font-medium text-gray-700 mb-3"
    >{{ label }}</label
  >
  <div class="flex flex-wrap gap-2" id="interestTags">
    {% for tag in tags %}
    <button
      type="button"
      class="tag-btn px-3 py-1 rounded-full text-sm font-medium border transition-colors bg-white text-gray-700 border-gray-300"
      data-value="{{ tag }}"
    >
      {{ tag }}
    </button>
    {% endfor %}
  </div>
  <input type="hidden" name="interests" id="interests-input" value="" />
</div>
{% endmacro %} {% macro tag_button_script(input_id="selectedInterests") %}
<script>
  // 태그 선택 로직
  const tagButtons = document.querySelectorAll(".tag-btn");
  const selectedInterestsInput = document.getElementById("{{ input_id }}");
  const selectedInterests = new Set();

  tagButtons.forEach((btn) => {
    btn.addEventListener("click", function (e) {
      e.preventDefault();
      const value = this.dataset.value;

      if (selectedInterests.has(value)) {
        // 선택 해제
        selectedInterests.delete(value);
        this.classList.remove("bg-blue-500", "text-white", "border-blue-500");
        this.classList.add("bg-white", "text-gray-700", "border-gray-300");
      } else {
        // 선택
        selectedInterests.add(value);
        this.classList.remove("bg-white", "text-gray-700", "border-gray-300");
        this.classList.add("bg-blue-500", "text-white", "border-blue-500");
      }

      // hidden input 업데이트
      selectedInterestsInput.value = Array.from(selectedInterests).join(",");
    });
  });

  // 전역 함수로 선택된 관심사 반환
  window.getSelectedInterests = function () {
    return Array.from(selectedInterests);
  };

  // 전역 함수로 관심사 선택상태 설정
  window.setSelectedInterests = function (interests) {
    selectedInterests.clear();
    tagButtons.forEach((btn) => {
      btn.classList.remove("bg-blue-500", "text-white", "border-blue-500");
      btn.classList.add("bg-white", "text-gray-700", "border-gray-300");
    });

    interests.forEach((interest) => {
      selectedInterests.add(interest);
      const btn = document.querySelector(`.tag-btn[data-value="${interest}"]`);
      if (btn) {
        btn.classList.remove("bg-white", "text-gray-700", "border-gray-300");
        btn.classList.add("bg-blue-500", "text-white", "border-blue-500");
      }
    });

    selectedInterestsInput.value = interests.join(",");
  };
</script>
{% endmacro %}
